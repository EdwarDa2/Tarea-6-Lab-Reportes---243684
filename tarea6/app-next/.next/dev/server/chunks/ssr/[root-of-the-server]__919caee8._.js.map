{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nlet connectionString = process.env.DATABASE_URL;\r\n\r\nif (!connectionString) {\r\n  connectionString = 'postgres://postgres:postgres@localhost:5432/actividad_db';\r\n}\r\n\r\n\r\n\r\nconst pool = new Pool({\r\n  connectionString,\r\n});\r\n\r\nexport const query = async (text: string, params?: any[]) => {\r\n  try {\r\n    const res = await pool.query(text, params);\r\n    return res;\r\n  } catch (error) {\r\n    console.error('‚ùå Error ejecutando query:', text);\r\n    throw error;\r\n  }\r\n};"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,IAAI,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAE/C,IAAI,CAAC,kBAAkB;IACrB,mBAAmB;AACrB;AAIA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB;AACF;AAEO,MAAM,QAAQ,OAAO,MAAc;IACxC,IAAI;QACF,MAAM,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM;QACnC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,MAAM;IACR;AACF"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/reports/2/page.tsx"],"sourcesContent":["import { query } from '../../lib/db';\r\nimport Link from 'next/link';\r\nimport { z } from 'zod';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nconst filterSchema = z.object({\r\n  nivel: z.enum(['Platino', 'Oro', 'Estandar']).optional(),\r\n});\r\n\r\ninterface ClientVip {\r\n  nombre: string;\r\n  email: string;\r\n  total_ordenes: number;\r\n  gasto_historico: string;\r\n  nivel_cliente: string;\r\n}\r\n\r\nexport default async function Reporte2({\r\n  searchParams,\r\n}: {\r\n  searchParams: Promise<{ nivel?: string }>;\r\n}) {\r\n  const params = await searchParams;\r\n  const parsed = filterSchema.safeParse(params);\r\n  const nivelSeleccionado = parsed.success ? parsed.data.nivel : undefined;\r\n\r\n  let clientes: ClientVip[] = [];\r\n  \r\n  if (nivelSeleccionado) {\r\n    const result = await query(\r\n      \"SELECT * FROM vw_clientes_vip WHERE nivel_cliente = $1 ORDER BY gasto_historico DESC\",\r\n      [nivelSeleccionado]\r\n    );\r\n    clientes = result.rows as ClientVip[];\r\n  } else {\r\n    const result = await query(\"SELECT * FROM vw_clientes_vip ORDER BY gasto_historico DESC\");\r\n    clientes = result.rows as ClientVip[];\r\n  }\r\n\r\n  return (\r\n    <main>\r\n      <Link href=\"/\" style={{ color: 'blue', marginBottom: '20px', display: 'block' }}>‚Üê Volver al Dashboard</Link>\r\n      \r\n      <h1>üíé Reporte 2: Clientes VIP</h1>\r\n      \r\n      <div style={{ \r\n        background: '#fef3c7', \r\n        border: '1px solid #fcd34d', \r\n        padding: '15px', \r\n        borderRadius: '8px', \r\n        marginBottom: '20px',\r\n        display: 'inline-block' \r\n      }}>\r\n        <span style={{ display: 'block', fontSize: '0.9rem', color: '#92400e' }}>\r\n          Clientes Encontrados ({nivelSeleccionado || 'Todos'})\r\n        </span>\r\n        <strong style={{ fontSize: '1.5rem', color: '#b45309' }}>{clientes.length}</strong>\r\n      </div>\r\n\r\n      <div style={{ marginBottom: '20px', padding: '15px', background: '#f9f9f9', borderRadius: '8px' }}>\r\n        <form style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\r\n          <label style={{ fontWeight: 'bold' }}>Filtrar por Nivel:</label>\r\n          \r\n          <select \r\n            name=\"nivel\" \r\n            defaultValue={nivelSeleccionado || ''}\r\n            style={{ padding: '8px', borderRadius: '4px', border: '1px solid #ccc', minWidth: '150px' }}\r\n          >\r\n            <option value=\"\">-- Ver Todos --</option>\r\n            <option value=\"Platino\">Platino (&gt; $1000)</option>\r\n            <option value=\"Oro\">Oro ($500 - $1000)</option>\r\n            <option value=\"Estandar\">Est√°ndar (&lt; $500)</option>\r\n          </select>\r\n\r\n          <button type=\"submit\" style={{ padding: '8px 15px', background: '#333', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' }}>\r\n            Aplicar\r\n          </button>\r\n        </form>\r\n      </div>\r\n\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Cliente</th>\r\n            <th>Email</th>\r\n            <th>Nivel</th>\r\n            <th>Total Gastado</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {clientes.length > 0 ? (\r\n            clientes.map((c, i) => (\r\n              <tr key={i}>\r\n                <td>{c.nombre}</td>\r\n                <td>{c.email}</td>\r\n                <td>\r\n                  <span style={{ \r\n                    padding: '4px 8px', \r\n                    borderRadius: '4px',\r\n                    background: c.nivel_cliente === 'Platino' ? '#e5e7eb' : \r\n                                c.nivel_cliente === 'Oro' ? '#fef3c7' : '#fff',\r\n                    fontWeight: 'bold',\r\n                    border: '1px solid #ccc'\r\n                  }}>\r\n                    {c.nivel_cliente}\r\n                  </span>\r\n                </td>\r\n                <td>${Number(c.gasto_historico).toFixed(2)}</td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan={4} style={{ textAlign: 'center', padding: '20px' }}>\r\n                No hay clientes con este nivel.\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}