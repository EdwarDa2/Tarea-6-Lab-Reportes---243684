{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nlet connectionString = process.env.DATABASE_URL;\r\n\r\nif (!connectionString) {\r\n  connectionString = 'postgres://postgres:postgres@localhost:5432/actividad_db';\r\n}\r\n\r\n\r\n\r\nconst pool = new Pool({\r\n  connectionString,\r\n});\r\n\r\nexport const query = async (text: string, params?: any[]) => {\r\n  try {\r\n    const res = await pool.query(text, params);\r\n    return res;\r\n  } catch (error) {\r\n    console.error('‚ùå Error ejecutando query:', text);\r\n    throw error;\r\n  }\r\n};"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,IAAI,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAE/C,IAAI,CAAC,kBAAkB;IACrB,mBAAmB;AACrB;AAIA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB;AACF;AAEO,MAAM,QAAQ,OAAO,MAAc;IACxC,IAAI;QACF,MAAM,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM;QACnC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,MAAM;IACR;AACF"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/reports/1/page.tsx"],"sourcesContent":["import { query } from '../../lib/db';\r\nimport Link from 'next/link';\r\n\r\nexport const dynamic = 'force-dynamic';\r\nconst ITEMS_PER_PAGE = 5; \r\n\r\ninterface ReporteFila {\r\n  categoria: string;\r\n  items_vendidos: number;\r\n  ingreso_total: string;\r\n}\r\n\r\nexport default async function Reporte1({ \r\n  searchParams \r\n}: { \r\n  searchParams: Promise<{ page?: string }> \r\n}) {\r\n  const params = await searchParams;\r\n  \r\n  const currentPage = Number(params.page) || 1;\r\n  const offset = (currentPage - 1) * ITEMS_PER_PAGE;\r\n\r\n  const kpiResult = await query('SELECT SUM(ingreso_total) as gran_total FROM vw_ventas_categoria');\r\n  const granTotal = Number(kpiResult.rows[0]?.gran_total || 0);\r\n\r\n  const countResult = await query('SELECT COUNT(*) as total FROM vw_ventas_categoria');\r\n  const totalItems = Number(countResult.rows[0]?.total || 0);\r\n  const totalPages = Math.ceil(totalItems / ITEMS_PER_PAGE);\r\n\r\n  const text = `\r\n    SELECT * FROM vw_ventas_categoria \r\n    ORDER BY ingreso_total DESC \r\n    LIMIT $1 OFFSET $2\r\n  `;\r\n  const result = await query(text, [ITEMS_PER_PAGE, offset]);\r\n  const ventas = result.rows as ReporteFila[];\r\n\r\n  return (\r\n    <main>\r\n      <Link href=\"/\" style={{ color: 'blue', marginBottom: '20px', display: 'block' }}>‚Üê Volver al Dashboard</Link>\r\n      \r\n      <h1>üìä Reporte 1: Ventas por Categor√≠a</h1>\r\n\r\n      <div style={{ \r\n        background: '#ecfdf5', \r\n        border: '1px solid #6ee7b7', \r\n        padding: '15px', \r\n        borderRadius: '8px',\r\n        marginBottom: '20px',\r\n        display: 'inline-block'\r\n      }}>\r\n        <span style={{ display: 'block', fontSize: '0.9rem', color: '#065f46' }}>Ingresos Totales (Global)</span>\r\n        <strong style={{ fontSize: '1.5rem', color: '#059669' }}>${granTotal.toFixed(2)}</strong>\r\n      </div>\r\n\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Categor√≠a</th>\r\n            <th>Items Vendidos</th>\r\n            <th>Ingreso Total</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {ventas.map((fila, index) => (\r\n            <tr key={index}>\r\n              <td>{fila.categoria}</td>\r\n              <td>{fila.items_vendidos}</td>\r\n              <td>${Number(fila.ingreso_total).toFixed(2)}</td>\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n\r\n      <div style={{ marginTop: '20px', display: 'flex', gap: '10px', justifyContent: 'center' }}>\r\n        {currentPage > 1 ? (\r\n          <Link href={`/reports/1?page=${currentPage - 1}`}><button style={btnStyle}>‚¨Ö Anterior</button></Link>\r\n        ) : <button style={{...btnStyle, opacity: 0.5}} disabled>‚¨Ö Anterior</button>}\r\n\r\n        <span>P√°gina {currentPage} de {totalPages || 1}</span>\r\n\r\n        {currentPage < totalPages ? (\r\n          <Link href={`/reports/1?page=${currentPage + 1}`}><button style={btnStyle}>Siguiente ‚û°</button></Link>\r\n        ) : <button style={{...btnStyle, opacity: 0.5}} disabled>Siguiente ‚û°</button>}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n\r\nconst btnStyle = { padding: '8px 16px', background: '#333', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' };"],"names":[],"mappings":";;;;;;;AAAA;AACA;;;;;;;;AAEO,MAAM,UAAU;AACvB,MAAM,iBAAiB;AAQR,eAAe,SAAS,EACrC,YAAY,EAGb;IACC,MAAM,SAAS,MAAM;IAErB,MAAM,cAAc,OAAO,OAAO,IAAI,KAAK;IAC3C,MAAM,SAAS,CAAC,cAAc,CAAC,IAAI;IAEnC,MAAM,YAAY,MAAM,IAAA,gIAAK,EAAC;IAC9B,MAAM,YAAY,OAAO,UAAU,IAAI,CAAC,EAAE,EAAE,cAAc;IAE1D,MAAM,cAAc,MAAM,IAAA,gIAAK,EAAC;IAChC,MAAM,aAAa,OAAO,YAAY,IAAI,CAAC,EAAE,EAAE,SAAS;IACxD,MAAM,aAAa,KAAK,IAAI,CAAC,aAAa;IAE1C,MAAM,OAAO,CAAC;;;;EAId,CAAC;IACD,MAAM,SAAS,MAAM,IAAA,gIAAK,EAAC,MAAM;QAAC;QAAgB;KAAO;IACzD,MAAM,SAAS,OAAO,IAAI;IAE1B,qBACE,8OAAC;;0BACC,8OAAC,0LAAI;gBAAC,MAAK;gBAAI,OAAO;oBAAE,OAAO;oBAAQ,cAAc;oBAAQ,SAAS;gBAAQ;0BAAG;;;;;;0BAEjF,8OAAC;0BAAG;;;;;;0BAEJ,8OAAC;gBAAI,OAAO;oBACV,YAAY;oBACZ,QAAQ;oBACR,SAAS;oBACT,cAAc;oBACd,cAAc;oBACd,SAAS;gBACX;;kCACE,8OAAC;wBAAK,OAAO;4BAAE,SAAS;4BAAS,UAAU;4BAAU,OAAO;wBAAU;kCAAG;;;;;;kCACzE,8OAAC;wBAAO,OAAO;4BAAE,UAAU;4BAAU,OAAO;wBAAU;;4BAAG;4BAAE,UAAU,OAAO,CAAC;;;;;;;;;;;;;0BAG/E,8OAAC;;kCACC,8OAAC;kCACC,cAAA,8OAAC;;8CACC,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;;;;;;;;;;;;kCAGR,8OAAC;kCACE,OAAO,GAAG,CAAC,CAAC,MAAM,sBACjB,8OAAC;;kDACC,8OAAC;kDAAI,KAAK,SAAS;;;;;;kDACnB,8OAAC;kDAAI,KAAK,cAAc;;;;;;kDACxB,8OAAC;;4CAAG;4CAAE,OAAO,KAAK,aAAa,EAAE,OAAO,CAAC;;;;;;;;+BAHlC;;;;;;;;;;;;;;;;0BASf,8OAAC;gBAAI,OAAO;oBAAE,WAAW;oBAAQ,SAAS;oBAAQ,KAAK;oBAAQ,gBAAgB;gBAAS;;oBACrF,cAAc,kBACb,8OAAC,0LAAI;wBAAC,MAAM,CAAC,gBAAgB,EAAE,cAAc,GAAG;kCAAE,cAAA,8OAAC;4BAAO,OAAO;sCAAU;;;;;;;;;;6CACzE,8OAAC;wBAAO,OAAO;4BAAC,GAAG,QAAQ;4BAAE,SAAS;wBAAG;wBAAG,QAAQ;kCAAC;;;;;;kCAEzD,8OAAC;;4BAAK;4BAAQ;4BAAY;4BAAK,cAAc;;;;;;;oBAE5C,cAAc,2BACb,8OAAC,0LAAI;wBAAC,MAAM,CAAC,gBAAgB,EAAE,cAAc,GAAG;kCAAE,cAAA,8OAAC;4BAAO,OAAO;sCAAU;;;;;;;;;;6CACzE,8OAAC;wBAAO,OAAO;4BAAC,GAAG,QAAQ;4BAAE,SAAS;wBAAG;wBAAG,QAAQ;kCAAC;;;;;;;;;;;;;;;;;;AAIjE;AAEA,MAAM,WAAW;IAAE,SAAS;IAAY,YAAY;IAAQ,OAAO;IAAS,QAAQ;IAAQ,cAAc;IAAO,QAAQ;AAAU"}}]
}