{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/lib/db.ts"],"sourcesContent":["import { Pool } from 'pg';\r\n\r\nlet connectionString = process.env.DATABASE_URL;\r\n\r\nif (!connectionString) {\r\n  connectionString = 'postgres://postgres:postgres@localhost:5432/actividad_db';\r\n}\r\n\r\n\r\n\r\nconst pool = new Pool({\r\n  connectionString,\r\n});\r\n\r\nexport const query = async (text: string, params?: any[]) => {\r\n  try {\r\n    const res = await pool.query(text, params);\r\n    return res;\r\n  } catch (error) {\r\n    console.error('‚ùå Error ejecutando query:', text);\r\n    throw error;\r\n  }\r\n};"],"names":[],"mappings":";;;;AAAA;;;;;;AAEA,IAAI,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAE/C,IAAI,CAAC,kBAAkB;IACrB,mBAAmB;AACrB;AAIA,MAAM,OAAO,IAAI,qJAAI,CAAC;IACpB;AACF;AAEO,MAAM,QAAQ,OAAO,MAAc;IACxC,IAAI;QACF,MAAM,MAAM,MAAM,KAAK,KAAK,CAAC,MAAM;QACnC,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,MAAM;IACR;AACF"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/reports/4/page.tsx"],"sourcesContent":["import { query } from '../../lib/db';\r\nimport Link from 'next/link';\r\nimport { z } from 'zod';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nconst filterSchema = z.object({\r\n  min: z.coerce.number().min(0).optional().default(0),\r\n});\r\n\r\ninterface ReporteMensual {\r\n  mes_anio: string;\r\n  transacciones: number;\r\n  facturacion: string;\r\n  iva_estimado: number;\r\n}\r\n\r\nexport default async function Reporte4({\r\n  searchParams,\r\n}: {\r\n  searchParams: Promise<{ min?: string }>;\r\n}) {\r\n  const params = await searchParams;\r\n  const parsed = filterSchema.safeParse(params);\r\n  const minVentas = parsed.success ? parsed.data.min : 0;\r\n\r\n  const text = `\r\n    SELECT * FROM vw_reporte_mensual \r\n    WHERE facturacion >= $1 \r\n    ORDER BY mes_anio DESC\r\n  `;\r\n  \r\n  const result = await query(text, [minVentas]);\r\n  const datos = result.rows as ReporteMensual[];\r\n\r\n  return (\r\n    <main>\r\n      <Link href=\"/\" style={{ color: 'blue', marginBottom: '20px', display: 'block' }}>‚Üê Volver al Dashboard</Link>\r\n      \r\n      <h1>üìÖ Reporte 4: Desempe√±o Mensual</h1>\r\n      \r\n      <div style={{ background: '#f4f4f4', padding: '15px', borderRadius: '8px', marginBottom: '20px' }}>\r\n        <form style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\r\n          <label htmlFor=\"min\" style={{ fontWeight: 'bold' }}>Filtrar ventas m√≠nimas ($):</label>\r\n          <input \r\n            type=\"number\" \r\n            name=\"min\" \r\n            defaultValue={minVentas}\r\n            placeholder=\"Ej: 500\"\r\n            style={{ padding: '8px', border: '1px solid #ccc', borderRadius: '4px' }}\r\n          />\r\n          <button type=\"submit\" style={{ padding: '8px 15px', background: '#333', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' }}>\r\n            Filtrar\r\n          </button>\r\n          \r\n          {minVentas > 0 && (\r\n            <Link href=\"/reports/4\" style={{ color: 'red', fontSize: '0.9rem' }}>\r\n              Borrar filtro\r\n            </Link>\r\n          )}\r\n        </form>\r\n        \r\n        {parsed.success && minVentas > 0 && (\r\n          <p style={{ marginTop: '10px', fontSize: '0.9rem', color: 'green' }}>\r\n            ‚úÖ Mostrando meses con facturaci√≥n superior a <strong>${minVentas}</strong>\r\n          </p>\r\n        )}\r\n      </div>\r\n\r\n      <table>\r\n        <thead>\r\n          <tr>\r\n            <th>Mes / A√±o</th>\r\n            <th>Total Transacciones</th>\r\n            <th>Facturaci√≥n Total</th>\r\n            <th>IVA Estimado (16%)</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {datos.length > 0 ? (\r\n            datos.map((d, i) => (\r\n              <tr key={i}>\r\n                <td>{d.mes_anio}</td>\r\n                <td>{d.transacciones}</td>\r\n                <td>${Number(d.facturacion).toFixed(2)}</td>\r\n                <td>${Number(d.iva_estimado).toFixed(2)}</td>\r\n              </tr>\r\n            ))\r\n          ) : (\r\n            <tr>\r\n              <td colSpan={4} style={{ textAlign: 'center', padding: '20px', color: '#666' }}>\r\n                No hay meses que cumplan con este criterio de ventas.\r\n              </td>\r\n            </tr>\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;;;;;;;;;AAEO,MAAM,UAAU;AAEvB,MAAM,eAAe,kLAAC,CAAC,MAAM,CAAC;IAC5B,KAAK,kLAAC,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,QAAQ,GAAG,OAAO,CAAC;AACnD;AASe,eAAe,SAAS,EACrC,YAAY,EAGb;IACC,MAAM,SAAS,MAAM;IACrB,MAAM,SAAS,aAAa,SAAS,CAAC;IACtC,MAAM,YAAY,OAAO,OAAO,GAAG,OAAO,IAAI,CAAC,GAAG,GAAG;IAErD,MAAM,OAAO,CAAC;;;;EAId,CAAC;IAED,MAAM,SAAS,MAAM,IAAA,gIAAK,EAAC,MAAM;QAAC;KAAU;IAC5C,MAAM,QAAQ,OAAO,IAAI;IAEzB,qBACE,8OAAC;;0BACC,8OAAC,0LAAI;gBAAC,MAAK;gBAAI,OAAO;oBAAE,OAAO;oBAAQ,cAAc;oBAAQ,SAAS;gBAAQ;0BAAG;;;;;;0BAEjF,8OAAC;0BAAG;;;;;;0BAEJ,8OAAC;gBAAI,OAAO;oBAAE,YAAY;oBAAW,SAAS;oBAAQ,cAAc;oBAAO,cAAc;gBAAO;;kCAC9F,8OAAC;wBAAK,OAAO;4BAAE,SAAS;4BAAQ,KAAK;4BAAQ,YAAY;wBAAS;;0CAChE,8OAAC;gCAAM,SAAQ;gCAAM,OAAO;oCAAE,YAAY;gCAAO;0CAAG;;;;;;0CACpD,8OAAC;gCACC,MAAK;gCACL,MAAK;gCACL,cAAc;gCACd,aAAY;gCACZ,OAAO;oCAAE,SAAS;oCAAO,QAAQ;oCAAkB,cAAc;gCAAM;;;;;;0CAEzE,8OAAC;gCAAO,MAAK;gCAAS,OAAO;oCAAE,SAAS;oCAAY,YAAY;oCAAQ,OAAO;oCAAS,QAAQ;oCAAQ,cAAc;oCAAO,QAAQ;gCAAU;0CAAG;;;;;;4BAIjJ,YAAY,mBACX,8OAAC,0LAAI;gCAAC,MAAK;gCAAa,OAAO;oCAAE,OAAO;oCAAO,UAAU;gCAAS;0CAAG;;;;;;;;;;;;oBAMxE,OAAO,OAAO,IAAI,YAAY,mBAC7B,8OAAC;wBAAE,OAAO;4BAAE,WAAW;4BAAQ,UAAU;4BAAU,OAAO;wBAAQ;;4BAAG;0CACtB,8OAAC;;oCAAO;oCAAE;;;;;;;;;;;;;;;;;;;0BAK7D,8OAAC;;kCACC,8OAAC;kCACC,cAAA,8OAAC;;8CACC,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;;;;;;;;;;;;kCAGR,8OAAC;kCACE,MAAM,MAAM,GAAG,IACd,MAAM,GAAG,CAAC,CAAC,GAAG,kBACZ,8OAAC;;kDACC,8OAAC;kDAAI,EAAE,QAAQ;;;;;;kDACf,8OAAC;kDAAI,EAAE,aAAa;;;;;;kDACpB,8OAAC;;4CAAG;4CAAE,OAAO,EAAE,WAAW,EAAE,OAAO,CAAC;;;;;;;kDACpC,8OAAC;;4CAAG;4CAAE,OAAO,EAAE,YAAY,EAAE,OAAO,CAAC;;;;;;;;+BAJ9B;;;;sDAQX,8OAAC;sCACC,cAAA,8OAAC;gCAAG,SAAS;gCAAG,OAAO;oCAAE,WAAW;oCAAU,SAAS;oCAAQ,OAAO;gCAAO;0CAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS9F"}}]
}